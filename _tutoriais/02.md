---
layout: tutorial-interno
titulo: Tutoriais - Ruby on Rails
titulo-principal: Rails
conteudo:
assuntos:
- principal: "O que é?"
  link: "#RailsAbout"
- principal: "Teoria"
  titulos:
    - name: Estrutura Básica
      link: "#RailsBasicStruct"
    - name: Rotas
      link: "#RailsRoutesAndHTTP"
- principal: "Prática"
  titulos:
    - name: Instalação Rails
      link: "#RailsInstall"
    - name: Criando novo projeto
      link: "#RailsCreateNew"
    - name: Iniciando o servidor
      link: "#RailsStartingServer"
    - name: Iniciando o VS Code  
      link: "#RailsStartingVScode"
    - name: Gerando controller
      link: "#RailsGeneratingController"
    - name: Alterando view
      link: "#RailsModifingView"
    - name: Mudando a home pelas rotas
      link: "#RailsRoutesRoot"
    - name: Criando rotas para articles
      link: "#RailsRoutesArticles"
    - name: Criando controller para articles
      link: "#RailsArticleCreatingController"
    - name: Criando view para um novo article
      link: "#RailsViewNewArticle"
    - name:  Criando método new no controller
      link: "#RailsArticleControllerNew"
    - name: Criando método create no controller
      link: "#RailsArticleControllerCreate"
    - name:  Definindo parametros de segurança
      link: "#RailsArticleControllerParams"
---


## O que é? {#RailsAbout}
Rails é uma framework web, ou seja, um conjunto de bibliotecas e métodos conseguir usar a linguagem ruby para criar aplicações de cliente servidor de forma mais simplificada.

## Teoria

### Estrutura Básica {#RailsBasicStruct}

Ele utiliza o padrão de projetos mvc (Model View Control) que consiste em ter uma divisão bem clara entre os três:

**Model** - Parte mais interna onde ficam o domínio do seu projeto, ou seja , a parte onde ficarão as regras de negócio, as classes auxiliares como serviços e políticas e a parte de integração de banco de dados (se você já não estiver usando uma framework como o Active Records para auxilia-lo).

**View** - Como na maioria das aplicações web existe um template view, ou seja, um template que mistura a linguagem determinada com html para conseguir criar uma respota HTML para o cliente. No caso do Rails, ele usa os arquivos **.erb**.

**Controller** - É a camada que irá ficar entre o model e o view. Essa camada é normalmente representada por classes que chamam métodos que pertencem ao model e os métodos do controller são chamados pelas [routas](#RailsRoutesAndHTTP) que irá trabalhar com as requisições.

Tantos os arquivos da camada de model quanto da camada de controller são arquivos **rb**. Ou seja, arquivos fonte ruby. E, por isso, trabalham como classes normais rails.

Além disso, o rails, normalmente, trabalha em conjunto com a framework [Active Records](#RailsActiveRecords) que é o pattern mais simples de criar um banco de dados.

### Rotas e métodos HTTP {#RailsRoutesAndHTTP}

Rotas ou routes é um arquivo que representa o pattern de page controller. Esse pattern consiste em mapear diremente os métodos http com os métodos da lingugem determinada, no caso aqui ruby com a framework rails.

Uma aplicação web tem dois lados, que são os dispositivos que irão processá-la. Existe o lado do cliente, que processa apenas arquivos **html**, **css** e **javascript**. Normalmente, quando se cria um site estático apenas existe essa parte, de servidor. Porém, em aplicações web, há o lado do servidor que processa as requisições que vem em forma dos métodos http e juntamente com links dinâmicos, que não têm um arquivo físico apontando para ele. 

Normalmente, os métodos http são utilizado nas tags form do html para que no caso do botão clicado possa enviar uma requisição para o servidor.

Método HTTP | Comando sql equivalente |O que ele faz
---|---|---
Get | select |Usado qaundo queremos obter algum recurso do servidor.
Post | insert |É utilizado para submeter uma entidade a um recurso específico juntamente com um link.
Put | update |Substitui todas as atuais representações do recurso de destino pela carga de dados da requisição.
Delete | delete | Remove o recurso específico.

Lembrando que o servidor irá agir de acordo como o programador criar. E, por isso, nem sempre, os métodos http são respeitados.

Mesmo assim, o rails facilita o programador porque ele já cria o sistema de rotas o qual irá dizer qual método http corresponde ao método do controller para conseguir fazer uma mapeamento das duas tecnologias.


## Prática

### Instalação do Rails {#RailsInstall}
O rails é um pouco mais reativo no windows. Porém é possível instalá-lo instalando o ruby. 

#### No Windows: 
No windows é possível instalar o rails dentro de um pacote com vários programas num executável, porém, a versão do ruby é 2.3.3:
[RailsInstaller.exe](https://s3.amazonaws.com/railsinstaller/Windows/railsinstaller-3.4.0.exe).

### No debian e derivados
Derivados: Ubuntu, Mint
~~~bash
  sudo apt-get install ruby
~~~

#### No RedHatOs e derivados
Derivados: Fedora, CentOs 
~~~bash
  sudo yum install ruby
~~~
#### No Arch e derivados
Derivados: Manjaro

~~~bash
  sudo pacman -S ruby
~~~

Para mais informações sobre a instalação do ruby visite: [o site do ruby](https://www.ruby-lang.org/pt/documentation/installation/#rubyinstaller) e leia da sua documentação.

Uma vez instalado o ruby, é necessário instalar a biblioteca do rails e suas dependências, no ruby, as bibliotecas são gemas ou **gems**

Então deverá colocar no terminal:
~~~bash
  gem install bundler
  gem install rails
~~~

Depois de instalar o rails, o ambiente estará pronto para começar.

### Criando novo projeto {#RailsCreateNew}
![Criando Nova Aplicação Rails](/assets/images/gifs/rails/j/01-RailsCreateNew.gif)
Nesse momento o rails começa a criar todos os arquivos que são importantes para o projeto incluindo o próprio rails dentro da pasta bin. O comando usado foi:
~~~bash
  rails new blog
~~~
Esse comando poderia ser usado para criar um projeto com qualquer nome:
~~~bash
  rails new 'nome do projeto'

~~~

### Iniciando o servidor {#RailsStartingServer}
![Abrindo o servidor](/assets/images/gifs/rails/j/02-RailsStartingServer-J.gif)
Aqui vemos como o rails consegue rodar uma aplicação o comando usado foi:

~~~bash
  bin/rails server
~~~

Existe também uma variação para esse comando dizendo a porta onde o servidor irá atuar esse exemplo é com a porta 80:

~~~bash
  bin/rails server -p 80
~~~

Para encerrar o servidor é clique no terminal **CTRL  C** .

### Iniciando o VSCode {#RailsStartingVScode}
![Abrindo VS Code](/assets/images/gifs/rails/v/03-RailsStartingVScode.gif)
Aqui vemos a inicialização do vscode no linux para conseguirmos trabalhar no nosso código ruby e rails mais facilmente.

### Gerando um controller {#RailsGeneratingController}
![Gerando controller](/assets/images/gifs/rails/j/03-RailsCreatingController.gif)

Aqui o comando que gera o controller cria a view e o controller respectivo para as requisições dele. Lembrando que [controller](#RailsBasicStruct) e [requisições](#RailsRoutesAndHTTP) foram explicadas anteriormente.

### Alterando view {#RailsModifingView}
![Alterando view](/assets/images/gifs/rails/j/06-ViewHelloRails.gif)

A view está na pasta **[seu projeto]/app/views/welcome/index.html.erb**. [Como dito](#RailsBasicStruct), nela é possível misturar o ruby com as tags HTML para conseguir criar um efeito dinâmico nas páginas.

### Mudando a home pelas rotas {#RailsRoutesRoot}
![Colocando a home pelas rotas](/assets/images/gifs/rails/j/05-RailsSettingRoute.gif)

As rotas mapeam os métodos http para os métodos do controller determinado. Uma vez criado o controller, já é criado dentro do routes o endereço dinâmico: **[nome do site][nome do controller]/index** . Esses endereços são simbólicos, ou seja, tão existe necessariamente um arquivo html para eles. Porém, existe um método do controller que será associado a esse link para o caso da eventual requisição e o método [http](#RailsRoutesAndHTTP) que ele cumprirá. Os métodos dos controllers são representados por **[Controller]#[método]**.

### Criando rotas para articles {#RailsRoutesArticles}
![Criando rotas articles](/assets/images/gifs/rails/j/7_criando_rotas_para_articles.gif)

Naturalmente seria necessário adicionar as rotas para cada método http. Porém isso pode ser abreviado pelo **resources** que você coloca antes de articles. Ele cria as rotas para os métodos http padrão de crud. Porém, é necessário criar o controller e as views necessárias para o funcionamento da aplicação.

### Criando um controller para Articles {#RailsArticleCreatingController}

![Crindo controller para article](/assets/images/gifs/rails/j/8_criando_o_controler_Articles.gif)
Após a requisição da rota, o rails faz a chamada do método que foi referenciado nas rotas conseguir fazer uso da camada de domínio e banco de dados no model e a após isso fazer uso da view.

### Criando view para um novo article {#RailsViewNewArticle}
![Criado view new article](/assets/images/gifs/rails/j/9_criando_view_newarticle.gif)

### Criando método new no controller {#RailsArticleControllerNew}
![Criando método new no controller](/assets/images/gifs/rails/j/10_criando_funcao_new.gif)

### Criando método create no controller {#RailsArticleControllerCreate}
![Criando método new no controller](/assets/images/gifs/rails/j/11_criando_funcao_create.gif)


### Definindo parametros de segurança {#RailsArticleControllerParams}
![Criando método new no controller](/assets/images/gifs/rails/j/12_definindo_parametros_funcao_create.gif)